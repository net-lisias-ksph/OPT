PART
{
	// --- general parameters ---
	name = J61
	module = Part
	author = K.Yeon
	tags = opt mk2

	// --- asset parameters ---
	scale = 1
	rescaleFactor = 1

	MODEL
	{
		model = OPT_Legacy/Parts/Engines/J61/OPT_J61
	}
 

	// --- node definitions ---
	node_stack_top = 0.0, 0.17904, 0.0, 0.0, 1.0, 0.0, 3
	//node_attach = 1.25, 0.0, 0.0, 0.0, 1.0, 0.0, 4	


	// --- editor parameters ---
	TechRequired = highAltitudeFlight
	entryCost = 18000
	cost = 2250
	category = Engine
	subcategory = 0
	title = OPT-E Advanced TurboRamjet "J-61 The Starwaster"
	manufacturer = OPT Propulsion Science Division
	description = This compact and vintage Mk2 engine has come to be widely known by both those who love OPT, and those who reject it. For an air-breather, the Starwaster is a force to be reckoned with, and an especially expensive ticket for those who want to go to space today. Maybe its nickname is to be taken seriously...

	
	// attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,1,1,1,0


	// --- standard part parameters ---
	mass = 2.5
	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.2
	angularDrag = 2
	crashTolerance = 12
	breakingForce = 400
	breakingTorque = 600
	maxTemp = 2700
	emissiveConstant = 0.8 // engine nozzles are good at radiating.
	bulkheadProfiles = mk2, srf

	MODULE
	{
		name = ModuleEnginesFX
		thrustVectorTransformName = thrustTransform
		exhaustDamage = True
		ignitionThreshold = 0.03
		minThrust = 0
		maxThrust = 380
		heatProduction = 291
		useEngineResponseTime = True
		engineAccelerationSpeed = 0.2
		engineDecelerationSpeed = 0.4
		useVelocityCurve = False
		flameoutEffectName = flameout
		powerEffectName = running_thrust
		engageEffectName = engage
		disengageEffectName = disengage
		spoolEffectName = running_turbine
		engineSpoolIdle = 0.05
		engineSpoolTime = 2.0
		EngineType = Turbine
		
		PROPELLANT
		{
			name = LiquidFuel
			resourceFlowMode = STAGE_STACK_FLOW_BALANCE
			ratio = 4
			DrawGauge = True
		}

		PROPELLANT
		{
			name = IntakeAir
			ignoreForIsp = True
			ratio = 9
		}

		atmosphereCurve
		{
			key = 0 3200
		}

		// Jet params
		atmChangeFlow = True
		useVelCurve = True
		useVelCurveIsp = True
		useAtmCurve = True
		machLimit = 6
		machHeatMult = 2.0

		velCurve
		{
			key = 0 0.6 0.2708152 0.9506099
			key = 1.505788 1.00779
			key = 2.986149 2.01154 0.02860518 0.02860518
			key = 4.41794 1.807048 -0.3693905 -0.3741931
			key = 6.000283 1.200063
			key = 7.50809 1.002025 0.003661203 0.003661203
		}
		velCurveIsp
		{
			// Isp multiplied by velocity
			key = 5 1 0 0
			key = 6.5 0.625 0 0
		}
		atmCurve
		{
			//Airflow vs max thrust?
			key = 0.003236246 1.001045 -0.05797033 -0.05797033
			key = 0.2 1.304954
			key = 0.3992449 0.8939289
			key = 1 0.6
			key = 5 0
		}
	}

	MODULE
	{
		name = ModuleAlternator

		RESOURCE
		{
			name = ElectricCharge
			rate = 5.0
		}
	}

	MODULE
	{
		name = ModuleSurfaceFX
		thrustProviderModuleIndex = 0
		fxMax = 0.6
		maxDistance = 25
		falloff = 2
		thrustTransformName = thrustTransform
	}

	MODULE
	{
		name = ModuleGimbal
		gimbalTransformName = thrustTransform
		gimbalResponseSpeed = 8
		useGimbalResponseSpeed = true
		gimbalRangeXP = 10
		gimbalRangeXN = 10
		gimbalRangeYP = 0
		gimbalRangeYN = 0
		gimbalRangeZP = 0
		gimbalRangeZN = 0
	}

	EFFECTS
	{		
		running_thrust
		{			
			PREFAB_PARTICLE
			{
				prefabName = fx_smokeTrail_light
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.05 0.0
				emission = 0.075 0.25
				emission = 1.0 1.25
				speed = 0.0 0.25
				speed = 1.0 1.0
				localOffset = 0, 0, 1
				localRotation = 1, 0, 0, -90
			}
			AUDIO
			{
				channel = Ship
				clip = sound_rocket_spurts
				volume = 0.0 0.0
				volume = 0.1 1.5
				volume = 1.0 2
				pitch = 0.0 0.2
				pitch = 1.0 1.0
				loop = true
			}
			
			AUDIO
			{
				name = jetsHumm
				channel = Ship
				clip = sound_jet_low
				volume = 0.0 0.0
				volume = 0.1 0.4
				volume = 0.6 0.8
				volume = 1.0 0.3
				volume = 1.5 0.2
				pitch = 0.0 0.1
				pitch = 0.5 0.2
				pitch = 1.0 2
				loop = true
				speed = 0.0 1.70
				speed = 1.0 1.65
			}

			AUDIO
			{
				name = jetscream
				channel = Ship
				clip = sound_jet_deep
				volume = 0.0 0.0
				volume = 0.1 1
				volume = 1.0 3.5
				volume = 1.7 5.5
				pitch = 0.0 0.8
				pitch = 0.5 1
				pitch = 1.0 3
				pitch = 1.7 5
				loop = true
				speed = 0.0 1.70
				speed = 1.0 1.95
			}
		
			AUDIO
			{
				name = jetscreamHighSpeed
				channel = Ship
				clip = sound_jet_low
				volume = 0.9 0.0
				volume = 1.0 0.1
				volume = 1.7 3
				volume = 5 5
				pitch = 0.9 1.5
				pitch = 2.7 3
				loop = true
				speed = 0.0 1
				speed = 1.0 1
			}

			AUDIO
			{
				name = rocketsound
				channel = Ship
				clip = sound_rocket_mini
				volume = 0.0 0.0
				volume = 1.0 0.8
				volume = 2.7 0.2
				pitch = 0.0 0.2
				pitch = 1.0 0.3
				pitch = 1.7 0.4
				loop = true
			}

			MODEL_MULTI_PARTICLE
			{
				name = flamethrust
				modelName = OPT_Legacy/FX/ramjet_fx
				transformName = FXNode
				emission = 0.0 0
				emission = 1.5 9
				speed = 0.0 0.2
				speed = 1.0 0.5
				speed = 1.5 1.0
			}
		}
		running_turbine
		{
			AUDIO
			{
				channel = Ship
				clip = sound_jet_low
				volume = 0.0 0.0
				volume = 0.05 0.7
				volume = 1.0 1.0
				pitch = 0.0 0.5
				pitch = 0.05 0.6
				pitch = 1.0 1.2
				loop = true
			}
		}
		
		engage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_medium
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
		
		disengage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_soft
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
		
		flameout
		{
			PREFAB_PARTICLE
			{
				prefabName = fx_exhaustSparks_flameout_2
				transformName = thrustTransform
				oneShot = true
			}
			
			AUDIO
			{
				channel = Ship
				clip = sound_explosion_low
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
	}

	MODULE
	{
		name = FXModuleAnimateThrottle
		animationName = engine_light
		dependOnEngineState = True
		responseSpeed = 0.01
	}
	
	MODULE
	{
		name = ModuleResourceIntake
		resourceName = IntakeAir
		checkForOxygen = true
		area = 0.0125
		intakeSpeed = 10
		intakeTransformName = intake_transform
	}

	RESOURCE
	{
		name = IntakeAir
		amount = 0.5
		maxAmount = 1.0
	}

	MODULE
	{
		name = ModuleLiftingSurface
		useInternalDragModel = False
		deflectionLiftCoeff = 0.1
		dragAtMaxAoA = 0.1
		dragAtMinAoA = 0
	}
}